var naming= // cn=chinese_name cb=chinese_brief en=english_name eb=english_brief
{"創":{"cn":"創世記","cb":"創","en":"Genesis","eb":"Gen"},
 "出":{"cn":"出埃及記","cb":"出","en":"Exodus","eb":"Exo"},
 "利":{"cn":"利未記","cb":"利","en":"Leviticus","eb":"Lev"},
 "民":{"cn":"民數記","cb":"民","en":"Numbers","eb":"Num"},
 "申":{"cn":"申命記","cb":"申","en":"Deuteronomy","eb":"Deu"},
 "書":{"cn":"約書亞記","cb":"書","en":"Joshua","eb":"Jos"},
 "士":{"cn":"士師記","cb":"士","en":"Judges","eb":"Jug"},
 "得":{"cn":"路得記","cb":"得","en":"Ruth","eb":"Rut"},
 "撒上":{"cn":"撒母耳記上","cb":"撒上","en":"1 Samuel","eb":"1Sa"},
 "撒下":{"cn":"撒母耳記下","cb":"撒下","en":"2 Samuel","eb":"2Sa"},
 "王上":{"cn":"列王紀上","cb":"王上","en":"1Kings","eb":"1Ki"},
 "王下":{"cn":"列王紀下","cb":"王下","en":"2Kings","eb":"2Ki"},
 "代上":{"cn":"歷代志上","cb":"代上","en":"1 Chronicles","eb":"1Ch"},
 "代下":{"cn":"歷代志下","cb":"代下","en":"2 Chronicles","eb":"2Ch"},
 "拉":{"cn":"以斯拉記","cb":"拉","en":"Ezra","eb":"Ezr"},
 "尼":{"cn":"尼希米記","cb":"尼","en":"Nehemiah","eb":"Neh"},
 "斯":{"cn":"以斯帖記","cb":"斯","en":"Esther","eb":"Est"},
 "伯":{"cn":"約伯記","cb":"伯","en":"Job","eb":"Job"},
 "詩":{"cn":"詩篇","cb":"詩","en":"Psalms","eb":"Psm"},
 "箴":{"cn":"箴言","cb":"箴","en":"Proverbs","eb":"Pro"},
 "傳":{"cn":"傳道書","cb":"傳","en":"Ecclesiastes","eb":"Ecc"},
 "歌":{"cn":"雅歌","cb":"歌","en":"Song of Songs","eb":"Son"},
 "賽":{"cn":"以賽亞書","cb":"賽","en":"Isaiah","eb":"Isa"},
 "耶":{"cn":"耶利米書","cb":"耶","en":"Jeremiah","eb":"Jer"},
 "哀":{"cn":"耶利米哀歌","cb":"哀","en":"Lamentations","eb":"Lam"},
 "結":{"cn":"以西結書","cb":"結","en":"Ezekiel","eb":"Eze"},
 "但":{"cn":"但以理書","cb":"但","en":"Daniel","eb":"Dan"},
 "何":{"cn":"何西阿書","cb":"何","en":"Hosea","eb":"Hos"},
 "珥":{"cn":"約珥書","cb":"珥","en":"Joel","eb":"Joe"},
 "摩":{"cn":"阿摩司書","cb":"摩","en":"Amos","eb":"Amo"},
 "俄":{"cn":"俄巴底亞書","cb":"俄","en":"Obadiah","eb":"Oba"},
 "拿":{"cn":"約拿書","cb":"拿","en":"Jonah","eb":"Jon"},
 "彌":{"cn":"彌迦書","cb":"彌","en":"Micah","eb":"Mic"},
 "鴻":{"cn":"那鴻書","cb":"鴻","en":"Nahum","eb":"Nah"},
 "哈":{"cn":"哈巴谷書","cb":"哈","en":"Habakkuk","eb":"Hab"},
 "番":{"cn":"西番雅書","cb":"番","en":"Zephaniah","eb":"Zep"},
 "該":{"cn":"哈該書","cb":"該","en":"Haggai","eb":"Hag"},
 "亞":{"cn":"撒迦利亞書","cb":"亞","en":"Zechariah","eb":"Zec"},
 "瑪":{"cn":"瑪拉基書","cb":"瑪","en":"Malachi","eb":"Mal"},
 "太":{"cn":"馬太福音","cb":"太","en":"Matthew","eb":"mat"},
 "可":{"cn":"馬可福音","cb":"可","en":"Mark","eb":"Mak"},
 "路":{"cn":"路加福音","cb":"路","en":"Luke","eb":"Luk"},
 "約":{"cn":"約翰福音","cb":"約","en":"John","eb":"Jhn"},
 "徒":{"cn":"使徒行傳","cb":"徒","en":"Acts","eb":"Act"},
 "羅":{"cn":"羅馬書","cb":"羅","en":"Romans","eb":"Rom"},
 "林前":{"cn":"哥林多前書","cb":"林前","en":"1 Corinthians","eb":"1Co"},
 "林後":{"cn":"哥林多後書","cb":"林後","en":"2 Corinthians","eb":"2Co"},
 "加":{"cn":"加拉太書","cb":"加","en":"Galatians","eb":"Gal"},
 "弗":{"cn":"以弗所書","cb":"弗","en":"Ephesians","eb":"Eph"},
 "腓":{"cn":"腓利比書","cb":"腓","en":"Philippians","eb":"Phl"},
 "西":{"cn":"歌羅西書","cb":"西","en":"Colossians","eb":"Col"},
 "帖前":{"cn":"帖撒羅尼迦前書","cb":"帖前","en":"1 Thessalonians","eb":"1Ts"},
 "帖後":{"cn":"帖撒羅尼迦後書","cb":"帖後","en":"2 Thessalonians","eb":"2Ts"},
 "提前":{"cn":"提摩太前書","cb":"提前","en":"1 Timothy","eb":"1Ti"},
 "提後":{"cn":"提摩太後書","cb":"提後","en":"2 Timothy","eb":"2Ti"},
 "多":{"cn":"提多書","cb":"多","en":"Titus","eb":"Tit"},
 "門":{"cn":"腓利門書","cb":"門","en":"Philemon","eb":"Phm"},
 "來":{"cn":"希伯來書","cb":"來","en":"Hebrews","eb":"Heb"},
 "雅":{"cn":"雅各書","cb":"雅","en":"James","eb":"Jas"},
 "彼前":{"cn":"彼得前書","cb":"彼前","en":"1 Peter","eb":"1Pe"},
 "彼後":{"cn":"彼得後書","cb":"彼後","en":"2 Peter","eb":"2Pe"},
 "約壹":{"cn":"約翰壹書","cb":"約壹","en":"1 John","eb":"1Jn"},
 "約貳":{"cn":"約翰貳書","cb":"約貳","en":"2 John","eb":"2Jn"},
 "約參":{"cn":"約翰參書","cb":"約參","en":"3 John","eb":"3Jn"},
 "猶":{"cn":"猶大書","cb":"猶","en":"Jude","eb":"Jud"},
 "啟":{"cn":"啟示錄","cb":"啟","en":"Revelation","eb":"Rev"}
 }
// console.log(naming["猶"])
var match, line, N, i, n
var text, testment, chinese_brief, chinese_name, english_brief
var chapter_index, verse_index, verse
var backs='';for(var j=0;j<5;j++)backs+=String.fromCharCode(8)
var fs=require('fs')
var f, files=['1ot','2nt']
var file_name, file_ext='xml', file
for (f=0;f<files.length;f++) {
	file_name=files[f]
	file=file_name+'.'+file_ext
	text=fs.readFileSync(file).toString().split('\r\n')
	console.log(text.length,'lines read from',file)
	for (i=0;i<text.length;i++) {
	//	if (i>20) break
		line=text[i]
		if (!line) continue
		if (match=line.match(/<檔 .+"(.+)\..+">/)) {
			n=match[1]
			line='<xml id="'+n+'.xml">'
			testment=n.substr(1)
		} else 
		if (match=line.match(/^<約>(.+?)<\/約>/)) {
			line='<testment id="'+testment+'">'+match[1]+'</testment>'
		} else 
		if (match=line.match(/<_頁 n="1" ?\/>/)) {
			line='<pb n="1"/>'
		} else 
		if (match=line.match(/<簡名>(.+?)<\/簡名>$/)) {
			chinese_brief=match[1], N=naming[chinese_brief]
		//	console.log(N)
			english_brief=N.eb, chinese_name=N.cn
			line='<book id="'+english_brief+'">'+chinese_brief+' ('+chinese_name+')</book>'
		} else 
		if (match=line.match(/^<章>.+?(\d+)<\/章>/)) {
		//	console.log(match)
			chapter_index=match[1]
			line='<chapter n="'+chapter_index+'">'+chinese_brief+chapter_index+'</chapter>'
		} else
		if (match=line.match(/<節>.+?:(\d+)<\/節> (.+)/)) {
			verse_index=match[1], verse=match[2].replace('　神','<god>神</god>')
			line='<verse n="'+verse_index+'"/>'+chinese_brief+chapter_index+':'+verse_index+' '+verse
		} else
		if (match=line.match(/<\/檔>/)) {
			line='</xml>'
		}
		if (match) {
	//		console.log(line)
			text[i]=line
		}
		n=i.toString()
		process.stdout.write(backs+'0000'.substr(0,5-n.length)+n)
	} // /*
	file=file_name+'1.'+file_ext
	console.log('\r\n'+n,'lines converted to',file,'utf-8')
	fs.writeFileSync(file,text.join('\r\n')) // */
}